/* This file has been generated from /home/lionel/paparazziProto1/conf/airframes/VAMUdeS/valkyrie.xml */
/* Please DO NOT EDIT */

#ifndef AIRFRAME_H
#define AIRFRAME_H

#define AIRFRAME_NAME "Colibri"
#define AC_ID 2
#define MD5SUM ((uint8_t*)"\305\167\006\355\133\042\273\137\367\335\327\014\337\122\071\246")

#define SERVOS_NB 8

#define SERVO_THROTTLE 0
#define SERVO_THROTTLE_NEUTRAL 1000
#define SERVO_THROTTLE_TRAVEL_UP 0.104166666667
#define SERVO_THROTTLE_TRAVEL_DOWN 0.00729166666667
#define SERVO_THROTTLE_MAX 2000
#define SERVO_THROTTLE_MIN 930

#define SERVO_AILERON_LEFT 1
#define SERVO_AILERON_LEFT_NEUTRAL 1500
#define SERVO_AILERON_LEFT_TRAVEL_UP -0.0520833333333
#define SERVO_AILERON_LEFT_TRAVEL_DOWN -0.0520833333333
#define SERVO_AILERON_LEFT_MAX 2000
#define SERVO_AILERON_LEFT_MIN 1000

#define SERVO_AILERON_RIGHT 2
#define SERVO_AILERON_RIGHT_NEUTRAL 1500
#define SERVO_AILERON_RIGHT_TRAVEL_UP -0.0520833333333
#define SERVO_AILERON_RIGHT_TRAVEL_DOWN -0.0520833333333
#define SERVO_AILERON_RIGHT_MAX 2000
#define SERVO_AILERON_RIGHT_MIN 1000

#define SERVO_RUDDER 4
#define SERVO_RUDDER_NEUTRAL 1500
#define SERVO_RUDDER_TRAVEL_UP 0.0520833333333
#define SERVO_RUDDER_TRAVEL_DOWN 0.0520833333333
#define SERVO_RUDDER_MAX 2000
#define SERVO_RUDDER_MIN 1000

#define SERVO_FLAPS 5
#define SERVO_FLAPS_NEUTRAL 1230
#define SERVO_FLAPS_TRAVEL_UP 0.0802083333333
#define SERVO_FLAPS_TRAVEL_DOWN 0
#define SERVO_FLAPS_MAX 2000
#define SERVO_FLAPS_MIN 1230

#define SERVO_GYRO_G 6
#define SERVO_GYRO_G_NEUTRAL 1500
#define SERVO_GYRO_G_TRAVEL_UP 0.0520833333333
#define SERVO_GYRO_G_TRAVEL_DOWN 0.0520833333333
#define SERVO_GYRO_G_MAX 2000
#define SERVO_GYRO_G_MIN 1000

#define SERVO_ELEVATOR 7
#define SERVO_ELEVATOR_NEUTRAL 1500
#define SERVO_ELEVATOR_TRAVEL_UP 0.0520833333333
#define SERVO_ELEVATOR_TRAVEL_DOWN 0.0520833333333
#define SERVO_ELEVATOR_MAX 2000
#define SERVO_ELEVATOR_MIN 1000


#define COMMAND_THROTTLE 0
#define COMMAND_PITCH 1
#define COMMAND_YAW 2
#define COMMAND_ROLL 3
#define COMMAND_GYRO_GAIN 4
#define COMMANDS_NB 5
#define COMMANDS_FAILSAFE {0,0,0,0,0}


#define SECTION_MIXER 1
#define AILERON_DIFF 1
#define COMBI_SWITCH -0.4

#define SetActuatorsFromCommands(values) { \
  uint32_t servo_value;\
  float command_value;\
  int16_t _var_roll = values[COMMAND_ROLL];\
  command_value = values[COMMAND_GYRO_GAIN];\
  command_value *= command_value>0 ? SERVO_GYRO_G_TRAVEL_UP : SERVO_GYRO_G_TRAVEL_DOWN;\
  servo_value = SERVO_GYRO_G_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_GYRO_G] = ChopServo(servo_value, SERVO_GYRO_G_MIN, SERVO_GYRO_G_MAX);\
\
  Actuator(SERVO_GYRO_G) = SERVOS_TICS_OF_USEC(actuators[SERVO_GYRO_G]);\
\
  command_value = values[COMMAND_PITCH];\
  command_value *= command_value>0 ? SERVO_ELEVATOR_TRAVEL_UP : SERVO_ELEVATOR_TRAVEL_DOWN;\
  servo_value = SERVO_ELEVATOR_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_ELEVATOR] = ChopServo(servo_value, SERVO_ELEVATOR_MIN, SERVO_ELEVATOR_MAX);\
\
  Actuator(SERVO_ELEVATOR) = SERVOS_TICS_OF_USEC(actuators[SERVO_ELEVATOR]);\
\
  command_value = values[COMMAND_YAW];\
  command_value *= command_value>0 ? SERVO_RUDDER_TRAVEL_UP : SERVO_RUDDER_TRAVEL_DOWN;\
  servo_value = SERVO_RUDDER_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_RUDDER] = ChopServo(servo_value, SERVO_RUDDER_MIN, SERVO_RUDDER_MAX);\
\
  Actuator(SERVO_RUDDER) = SERVOS_TICS_OF_USEC(actuators[SERVO_RUDDER]);\
\
  command_value = (_var_roll > 0 ? 1 : AILERON_DIFF) * _var_roll;\
  command_value *= command_value>0 ? SERVO_AILERON_LEFT_TRAVEL_UP : SERVO_AILERON_LEFT_TRAVEL_DOWN;\
  servo_value = SERVO_AILERON_LEFT_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_AILERON_LEFT] = ChopServo(servo_value, SERVO_AILERON_LEFT_MIN, SERVO_AILERON_LEFT_MAX);\
\
  Actuator(SERVO_AILERON_LEFT) = SERVOS_TICS_OF_USEC(actuators[SERVO_AILERON_LEFT]);\
\
  command_value = (_var_roll > 0 ? AILERON_DIFF : 1) * _var_roll;\
  command_value *= command_value>0 ? SERVO_AILERON_RIGHT_TRAVEL_UP : SERVO_AILERON_RIGHT_TRAVEL_DOWN;\
  servo_value = SERVO_AILERON_RIGHT_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_AILERON_RIGHT] = ChopServo(servo_value, SERVO_AILERON_RIGHT_MIN, SERVO_AILERON_RIGHT_MAX);\
\
  Actuator(SERVO_AILERON_RIGHT) = SERVOS_TICS_OF_USEC(actuators[SERVO_AILERON_RIGHT]);\
\
  command_value = values[COMMAND_THROTTLE];\
  command_value *= command_value>0 ? SERVO_THROTTLE_TRAVEL_UP : SERVO_THROTTLE_TRAVEL_DOWN;\
  servo_value = SERVO_THROTTLE_NEUTRAL + (int32_t)(command_value);\
  actuators[SERVO_THROTTLE] = ChopServo(servo_value, SERVO_THROTTLE_MIN, SERVO_THROTTLE_MAX);\
\
  Actuator(SERVO_THROTTLE) = SERVOS_TICS_OF_USEC(actuators[SERVO_THROTTLE]);\
\
  ActuatorsCommit();\
}

#define AllActuatorsInit() { \
  ActuatorsInit();\
}

#define SetCommandsFromRC(_commands_array, _rc_array) { \
  _commands_array[COMMAND_THROTTLE] = _rc_array[RADIO_THROTTLE];\
  _commands_array[COMMAND_ROLL] = _rc_array[RADIO_ROLL];\
  _commands_array[COMMAND_PITCH] = _rc_array[RADIO_PITCH];\
  _commands_array[COMMAND_YAW] = _rc_array[RADIO_YAW];\
}

#define SetApOnlyCommands(ap_commands) { \
}

#define SECTION_AUTO1 1
#define AUTO1_MAX_ROLL 0.785
#define AUTO1_MAX_PITCH 0.785

#define SECTION_INFRARED 1
#define IR_ADC_IR1_NEUTRAL 512
#define IR_ADC_IR2_NEUTRAL 512
#define IR_ADC_TOP_NEUTRAL 512
#define IR_IR_LATERAL_CORRECTION 1
#define IR_IR_LONGITUDINAL_CORRECTION 1
#define IR_IR_VERTICAL_CORRECTION 1.
#define IR_HORIZ_SENSOR_TILTED 1
#define IR_IR1_SIGN 1
#define IR_IR2_SIGN 1
#define IR_TOP_SIGN 1
#define IR_ROLL_NEUTRAL_DEFAULT 0.
#define IR_PITCH_NEUTRAL_DEFAULT 0.2359685146
#define IR_CORRECTION_UP 1
#define IR_CORRECTION_DOWN 1
#define IR_CORRECTION_LEFT 1
#define IR_CORRECTION_RIGHT 0.795

#define SECTION_HORIZONTAL CONTROL 1
#define H_CTL_PITCH_PGAIN 10172
#define H_CTL_PITCH_DGAIN 0.
#define H_CTL_ELEVATOR_OF_ROLL 824
#define H_CTL_ROLL_ATTITUDE_GAIN 8000
#define H_CTL_ROLL_RATE_GAIN 0.
#define H_CTL_ROLL_SLEW 250.
#define H_CTL_AILERON_OF_THROTTLE 0
#define H_CTL_COURSE_DGAIN 1.2
#define H_CTL_COURSE_PGAIN 1.144
#define H_CTL_COURSE_PRE_BANK_CORRECTION 1.31
#define H_CTL_ROLL_MAX_SETPOINT 0.785
#define H_CTL_PITCH_MIN_SETPOINT -RadOfDeg(45)
#define H_CTL_PITCH_MAX_SETPOINT RadOfDeg(45)

#define SECTION_VERTICAL CONTROL 1
#define V_CTL_ALTITUDE_PGAIN 0.142
#define V_CTL_ALTITUDE_MAX_CLIMB 0.5
#define V_CTL_AUTO_THROTTLE_PGAIN 0.008
#define V_CTL_AUTO_THROTTLE_IGAIN 0.25
#define V_CTL_AUTO_THROTTLE_DGAIN 0
#define V_CTL_AUTO_THROTTLE_CLIMB_THROTTLE_INCREMENT 0.15
#define V_CTL_AUTO_THROTTLE_PITCH_OF_VZ_PGAIN 0.14
#define V_CTL_AUTO_THROTTLE_PITCH_OF_VZ_DGAIN 0
#define V_CTL_AUTO_THROTTLE_DASH_TRIM -1000
#define V_CTL_AUTO_THROTTLE_LOITER_TRIM 1500
#define V_CTL_AUTO_THROTTLE_NOMINAL_CRUISE_THROTTLE 0.4
#define V_CTL_AUTO_THROTTLE_MIN_CRUISE_THROTTLE 0
#define V_CTL_AUTO_THROTTLE_MAX_CRUISE_THROTTLE 1
#define V_CTL_THROTTLE_SLEW_LIMITER 0.5

#define SECTION_AGGRESSIVE 1
#define AGR_BLEND_START 18
#define AGR_BLEND_END 8
#define AGR_CLIMB_THROTTLE 1
#define AGR_CLIMB_PITCH 0.52
#define AGR_CLIMB_NAV_RATIO 0.8
#define AGR_DESCENT_THROTTLE 0
#define AGR_DESCENT_PITCH -0.5
#define AGR_DESCENT_NAV_RATIO 1

#define SECTION_SIMU 1
#define WEIGHT 1.
#define YAW_RESPONSE_FACTOR 1.
#define ROLL_RESPONSE_FACTOR 1.

#define SECTION_MISC 1
#define NOMINAL_AIRSPEED 18
#define CARROT 5.
#define CONTROL_RATE 60
#define DEFAULT_CIRCLE_RADIUS 100


#endif // AIRFRAME_H
